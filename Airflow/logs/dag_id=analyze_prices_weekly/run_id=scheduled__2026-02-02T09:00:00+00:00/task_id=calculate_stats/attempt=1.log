[2026-02-12T16:52:54.752+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: analyze_prices_weekly.calculate_stats scheduled__2026-02-02T09:00:00+00:00 [queued]>
[2026-02-12T16:52:54.761+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: analyze_prices_weekly.calculate_stats scheduled__2026-02-02T09:00:00+00:00 [queued]>
[2026-02-12T16:52:54.762+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2026-02-12T16:52:54.777+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): calculate_stats> on 2026-02-02 09:00:00+00:00
[2026-02-12T16:52:54.793+0000] {standard_task_runner.py:60} INFO - Started process 200 to run task
[2026-02-12T16:52:54.798+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'analyze_prices_weekly', 'calculate_stats', 'scheduled__2026-02-02T09:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/analyze_prices_weekly.py', '--cfg-path', '/tmp/tmpeu0q327f']
[2026-02-12T16:52:54.803+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask calculate_stats
[2026-02-12T16:52:54.876+0000] {task_command.py:423} INFO - Running <TaskInstance: analyze_prices_weekly.calculate_stats scheduled__2026-02-02T09:00:00+00:00 [running]> on host d50450c1ce91
[2026-02-12T16:52:55.031+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='oracle' AIRFLOW_CTX_DAG_ID='analyze_prices_weekly' AIRFLOW_CTX_TASK_ID='calculate_stats' AIRFLOW_CTX_EXECUTION_DATE='2026-02-02T09:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2026-02-02T09:00:00+00:00'
[2026-02-12T16:52:55.146+0000] {logging_mixin.py:188} WARNING - /opt/***/dags/analyze_prices_weekly.py:40 FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
[2026-02-12T16:52:55.239+0000] {logging_mixin.py:188} INFO - 
ðŸ“ˆ STATISTIQUES PAR ARRONDISSEMENT
[2026-02-12T16:52:55.279+0000] {logging_mixin.py:188} INFO -                 prix                          prix_m2       
                mean  median  min   max count    mean median
code_postal                                                 
69000        1195.76  1145.0  550  2840    29   23.09  20.93
69001        1195.71  1010.0  498  2760    84   22.49  21.08
69002        1192.91  1177.5  453  3320   112   22.05  20.88
69003        1015.13   910.0  400  3000   174   21.52  19.22
69004        1105.01   990.0  490  2150    86   22.61  21.45
69005        1011.20   977.5  310  2500    54   21.92  20.11
69006        1293.03  1153.5  405  3191   112   22.84  21.70
69007         939.06   853.0  381  3000   155   21.49  20.00
69008         910.16   896.0  453  2100   131   21.38  18.93
69009        1055.93   950.0  420  2995    85   19.55  18.00
[2026-02-12T16:52:55.295+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/analyze_prices_weekly.py", line 56, in calculate_stats
    json.dump({
  File "/usr/local/lib/python3.11/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/local/lib/python3.11/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/local/lib/python3.11/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/local/lib/python3.11/json/encoder.py", line 377, in _iterencode_dict
    raise TypeError(f'keys must be str, int, float, bool or None, '
TypeError: keys must be str, int, float, bool or None, not tuple
[2026-02-12T16:52:55.322+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=analyze_prices_weekly, task_id=calculate_stats, execution_date=20260202T090000, start_date=20260212T165254, end_date=20260212T165255
[2026-02-12T16:52:55.334+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 5 for task calculate_stats (keys must be str, int, float, bool or None, not tuple; 200)
[2026-02-12T16:52:55.353+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2026-02-12T16:52:55.387+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
